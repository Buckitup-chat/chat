<style type="text/css">
  .popup {
    z-index: 20;
    background: white;
    border: none;
    padding: 10px;
    width: 24rem;
    display: flex;
    justify-content: space-between;
    flex-direction: column;
    border-radius: 0.5rem;
    font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji";
  }

  .description {
    color: rgb(0 0 0 / 0.5);
    font-size: 0.875rem;
    line-height: 1.25rem;
    padding: 10px 0;
  }

  .roomCount {
    color: #EF4444;
    font-size: 0.875rem;
    line-height: 1.25rem;
    padding: 10px 0;
    display: none;
  }

  .downloadKeyBtn {
    background-color: black;
    border-radius: 0.5rem;
    height: 3rem;
    color: white;
    border: none;
    cursor: pointer;
  }

  .btnContainer {
    display: flex;
    justify-content: space-around;
    flex-direction: column;
    height: 200px;
  }

  .logoutButton,
  .cancelBtn {
    height: 3rem;
    background-color: white;
    border: 1px ridge;
    border-radius: 0.5rem;
    cursor: pointer;
  }

  .closeBtn {
    width: 15px;
    height: 15px;
    margin-left: 22.5rem;
    border: none;
    background: none;
    cursor: pointer;
  }

  .modalContainer {
    visibility: hidden;
    z-index: 10;
    width: 100vw;
    height: 100vh;
    background: rgba(0, 0, 0, 0.5);
    position: absolute;
    bottom: 0vh;
    display: flex;
    justify-content: center;
    align-items: center;
  }
</style>


<div id="modalContainer" class="modalContainer">
  <div id='popup' class="popup">
    <button id="closePopupBtn" class="closeBtn">X</button>
    <h4 class="title">Log Out & Back Up</h4>
    <p class="roomCount" id="roomCount"></p>
    <p class="description">To get access again you will need the recovery keys:</p>
    <div class="btnContainer">
      <button id="downloadKeyBtn" class="downloadKeyBtn">
        Download the Keys
      </button>
      <button id="logoutButton" class="logoutButton">
        Log Out without the Key
      </button>
      <button id="cancelBtn" class="cancelBtn">
        Cancel
      </button>
    </div>
  </div>
</div>


<script>
  const logout = document.getElementById("logoutButton");
  const modal = document.getElementById("modalContainer");
  const downloadKey = document.getElementById("downloadKeyBtn");
  const downloadKeyForm = document.getElementById("formContainer");
  const cancelBtn = document.getElementById('cancelBtn');
  const closeBtn = document.getElementById('closePopupBtn');
  const roomCount = localStorage.getItem("buckitUp-room-count-v2");
  console.log(+roomCount, typeof + roomCount)

  if (+roomCount > 0) {
    const roomCountBlock = document.getElementById("roomCount");
    roomCountBlock.innerHTML =
      `You have ${roomCount} room not backed up. Download the keys to make sure you have access to them after logging out.`;
    roomCountBlock.style.display = "block"
  }

  logout.addEventListener("click", () => {
    const confirm = document.getElementById('confirmModalContainer');
    modal.style.visibility = "hidden"
    confirm.style.visibility = "visible";
  })

  cancelBtn.addEventListener('click', () => {
    modal.style.visibility = "hidden";
  })

  closeBtn.addEventListener('click', () => {
    modal.style.visibility = "hidden";
  })

  downloadKey.addEventListener('click', () => {
    modal.style.visibility = "hidden";
    downloadKeyForm.style.visibility = "visible";
  })
</script>